<!DOCTYPE html>
<html>

<meta charset="UTF-8">
<style>

 #data {
        writing-mode: vertical-rl;
        text-orientation: mixed;
        word-wrap:break-word;
        white-space: normal;
        max-height: 500px;


        float:right;
        
        padding:15px;
        user-select: none;
}


body{
    background-color: #202530;
    color:lightblue;
    font-size: 20px;
}
</style>
<body>


 


<script>

//-----------------------------------------------------------------------------
// global variables
//-----------------------------------------------------------------------------    

 
 
 var file_name;
 
 var PAGE_SIZE=50;
 var pageNumber=0;
 var lastPage=0;
 var book_name="jedi";
 window.onload=init;
//-----------------------------------------------------------------------------
//
//-----------------------------------------------------------------------------
   
function init() {

  pageNumber = (getCookie('pageNumber'));
  pageNumber=pageNumber.replace(/[\'\"]/g,"");
  doGet(book_name);  


  document.body.addEventListener('click', handleClick, true); 
  turnPage(0);
}


/**
//---------------------------------------------------------------------
//
//---------------------------------------------------------------------
*/

var global_token='';
function getCookie(x) {
  var cname=x;
  
  var name = cname + "=";
  var decodedCookie = decodeURIComponent(document.cookie);
  var ca = decodedCookie.split(';');
  for(var i = 0; i <ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      var result = c.substring(name.length, c.length);
      
      
      return result;
    }
  }
  return "";
}


/**
//---------------------------------------------------------------------
//
//---------------------------------------------------------------------
*/

  function createCookie(){
    
    document.cookie = 
    `pageNumber='${pageNumber}';SameSite=None; Secure; expires=Thu, 18 Dec 3013 12:00:00 UTC`; 
     
          
  }


//-----------------------------------------------------------------------------
//
//-----------------------------------------------------------------------------
function handleClick(){
  turnPage(1);
  createCookie();
}


//-----------------------------------------------------------------------------
//
//-----------------------------------------------------------------------------
function turnPage(number){
  pageNumber =parseInt(pageNumber)+parseInt(number);
  if(pageNumber<0 || !pageNumber){
    pageNumber=0;
  }

  document.getElementById('pageNumber').innerHTML=pageNumber +' / '+Math.ceil(lastPage/PAGE_SIZE);
}

window.oncontextmenu = function ()
{
    
    turnPage(-1);
    return false;     // cancel default menu
}

//-----------------------------------------------------------------------------
//
//-----------------------------------------------------------------------------
var global_length='';
var global_file='';
 async  function doGet(url) {
    url = "books/"+url;

        url+='.txt';


    url=url.replace(/%2F/g,"/");

      let response = await fetch(url);

   

    if (response.status === 200) {
        let data = await response.text();

         file = data.split("\n"); 
         //data = data.replace(/[\n\r][\n\r][\n\r]+/g,"\n\n");


         lastPage=file.length;
         document.getElementById('data').innerHTML=data.replace(/[\n\r]/g,"<br/>");
         
        
        
        // handle data
    }
}



</script>

<span id='pageNumber'>|</span>
<pre id='data'>x</pre><br/>


</body>
</html>


